<h1 align="center">
  <span>
    <img src="https://upload.wikimedia.org/wikipedia/commons/1/18/ISO_C%2B%2B_Logo.svg" 
         alt="C++ Logo" 
         width="72" valign="middle">
  </span>
  <span style="font-size: x-large;">&nbsp;Contribution Guide for JH Toolkit</span>
</h1>

<p align="center">
  <img
    src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/JeongHan-Bae/JH-Toolkit/main/version_badge.json"
    alt="badge"
    width="196"
  >
</p>

---

## 💡 Introduction

Thank you for contributing to **JH Toolkit**,
a **modern, RTTI-free C++20 toolkit** that embraces the **duck typing philosophy** —
where types are recognized by their **behavior**, not inheritance.

From version **1.3.3** onward, **JH Toolkit guarantees full compatibility with `-fno-rtti`**:  
no runtime type information is ever used.  
All functionality is implemented using **concepts**, **constexpr introspection**,
**macros**, and **system-level APIs** — not RTTI.

Every contribution helps advance the toolkit's goals of
**clarity**, **determinism**, and **zero-overhead abstraction** in C++.

---

## 🧩 Versioning and Release Strategy

### 🔢 Semantic Versioning

JH Toolkit follows **Semantic Versioning**:

```
MAJOR.MINOR.PATCH
```

| Level     | Purpose                                                      | Example         |
|-----------|--------------------------------------------------------------|-----------------|
| **PATCH** | Bug fixes, internal adjustments, or incremental improvements | `1.3.0 → 1.3.1` |
| **MINOR** | Adds new modules or extended behaviors                       | `1.2.0 → 1.3.0` |
| **MAJOR** | Structural or breaking API changes                           | `1.4.0 → 2.0.0` |

---

### 🧱 CMake as the Single Source of Truth

All versioning originates from the **top-level CMakeLists.txt**:  

```cmake
set(PROJECT_VERSION 1.3.3)
```

CMake's `PROJECT_VERSION` defines the **canonical version** for the entire project.  
Every other version reference (README badge, release, dependencies, docs) is automatically
generated by the workflow:

```bash
.github/workflows/generate_dependencies.py --get-version
```

This script retrieves the version from `CMakeLists.txt` and propagates it to:

* README version badge
* `version_badge.json`
* Release CI (`release.yml`)
* Dependency metadata (`dependencies.json`)

> **CMake is the only authoritative version source** —
> all other version values are derived dynamically from it.

---

### 🔁 LTS Synchronization Rules

1. **When modifying or extending a module/submodule**

  * Use the **oldest active LTS version** that includes that module as your update base.
  * Synchronize fixes or updates to **all LTS branches** containing that module.

2. **When extending functionality**

  * Minor semantic enrichments → increment **PATCH**.
  * New feature introduction → increment **MINOR**.

3. **When a large-scale refactor occurs** (e.g., `1.3.x-LTS → 1.3.3-dev`):

  * Maintain **alias interfaces** for backward compatibility through `1.3.x`.
  * Remove aliases in the next **MAJOR** or **MINOR** release.
  * Guarantee all `Major.Minor.x` versions remain **fully backward-compatible**.

4. **Lifecycle transitions**

  * Once a new stable (`1.3.3`) is released:

    * The previous `1.2.x-LTS` becomes **Maintenance (`1.2.x-Maintenance`)**.
  * When the next minor (`1.4.0`) stable version releases:

    * That maintenance branch transitions to **EOL (`1.2.x-EOL`)**.

> 🧩 **Why older LTS are retired after major refactors:**  
> Each new LTS ensures synchronization across active branches requires **minimal effort**.  
> By phasing out older baselines, JH Toolkit guarantees that
> all maintained versions share a unified structure and build process.

---

## 🧪 Development Workflow

### 🧵 Branch Policy

| Branch          | Purpose                            | Permissions                |
|-----------------|------------------------------------|----------------------------|
| `main`          | 📘 Documentation and metadata only | ❌ No direct source changes |
| `dev*` / `*dev` | 🧪 Development, CI, and testing    | ✅ Allowed, but discouraged |
| `<version>-dev` | 🧩 Recommended development branch  | ✅ Preferred                |
| `*-LTS`         | 🔒 Long-Term Support maintenance   | ❌ No direct source changes |

> ⚠️ Both `main` and all `LTS` branches are **protected** —  
> source modifications must always occur on a dev branch and be **merged** in.

---

### 🔄 Active and Legacy Workflow Model

#### 🧩 Active Series (e.g., `1.3.x`)

1. Work in `<version>-dev` (e.g., `1.3.3-dev`).
2. Merge `<version>-dev` → `main` when feature-complete.
3. Perform a manual CI run and release from `main`.
4. Merge `main` → corresponding LTS branch after release.

#### 🧱 Legacy or Older LTS

1. Sync changes only from **verified dev branches** (e.g., a security patch or cross-version fix).
2. Merge the verified update into the LTS branch.
3. Perform a release **directly from that LTS** once validated.

> 💡 This structure ensures both stability and consistency,
> while keeping LTS maintenance cost as low as possible.

---

### ⚙️ CI and Release Workflows

* CI triggers automatically for all `dev*` and `*dev` branches.
* `main` and all `LTS` branches require **manual CI runs** before release.
* Release CI (`release.yml`) dynamically obtains its version via:

```yaml
env:
  pack_version: ${{ steps.get_version.outputs.version }}
```

(`generate_dependencies.py --get-version` provides this value.)

---

## 🧾 Commit and PR Conventions

### ✅ Commit Message Format

All commits follow the format:

```
behavior(domain): one-line summary

Detailed description (optional, Markdown supported).
```

Examples:

```
ci(main): enhance workflows — add manual trigger and enforce LLVM@20
docs(main): revise README and API documentation — align with 1.3.3 release
fix(pool): ensure hash() is initialized before insert to avoid multithreaded mismatch
```

---

### ✅ Pull Request Format

PR descriptions may use Markdown and must include:  

* A clear explanation of **what changed**
* **Why** the change matters
* Any **compatibility** implications

> 🧩 PR titles should mirror commit style, not carry version tags.

---

## 🧱 Coding Guidelines

### 1. 🧩 STL-Conformant Naming and Behavior

* Use **`snake_case`** for all names.
* Follow STL semantics (`size()`, `value_type`, `iterator`, etc.).
* Avoid unnecessary macros; prefer constexpr and templates.

### 2. 🔢 Type and Layout Rules

* Use **fixed-width integers** (`uint32_t`, `int64_t`, etc.) for binary or layout-sensitive types.
* `size_t` is **required** only for **STL specialization templates**,
  where the standard mandates the exact type identity.
* For **STL-compatible templates**, `convertible_to<size_t>` is sufficient,
  allowing fixed-width integer interoperability.

### 3. 🔒 Ownership and Thread Safety

* Prefer `unique_ptr` / `shared_ptr` to raw pointers.
* Clearly define immutability and ownership semantics.
* Avoid implicit conversions between owning and non-owning references.

---

## 🔁 LTS Lifecycle Overview

| Stage           | Description                                              |
|-----------------|----------------------------------------------------------|
| **Active LTS**  | Receives synchronized bug fixes and module updates       |
| **Maintenance** | Receives critical updates only after next stable release |
| **EOL**         | Frozen, archived — no further maintenance                |

> LTS branches are **not frozen** by default —
> they remain synchronized with verified dev branches for shared module updates.

---

## 🚀 Contribution Workflow Summary

1. Branch from the latest `<version>-dev`.
2. Implement your feature, fix, or documentation improvement.
3. Follow the **commit message convention**.
4. Verify CI passes.
5. Merge `<version>-dev` → `main` for release,
   then sync `main` → corresponding LTS.
6. For legacy versions, merge verified updates from dev into LTS directly before release.

---

## 🙏 Acknowledgement

Your contributions help keep **JH Toolkit** modern, deterministic, and expressive.
Together we build a toolkit that is:

> **Behaviorally compatible, RTTI-free, type-safe, and concurrency-stable — all within pure C++20.**

Happy coding! 🦆
— *The JH Toolkit Project*
