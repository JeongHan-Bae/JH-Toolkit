<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JH-Toolkit: include/jh/ranges/to.h File Reference</title>
<link rel="icon" href="Jindallae.svg" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Oree.svg"/></td>
  <td id="projectalign">
   <div id="projectname">JH-Toolkit<span id="projectnumber">&#160;v1.4.0</span>
   </div>
   <div id="projectbrief">An engineering-oriented C++20 toolkit with duck-typed concepts, static design, async coroutines, and semantic containers — header-only, RTTI-free, and concurrency-friendly.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('to_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">to.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Container adaptation adaptor — constructs a target container <code>C</code> directly from a compatible range <code>R</code>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ranges&gt;</code><br />
<code>#include &quot;<a class="el" href="">jh/metax/adl_apply.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="">jh/conceptual/closable_container.h</a>&quot;</code><br />
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:jh_3A_3Aranges_3A_3Ato_5Ffn_3C_20C_20_3E" id="r_jh_3A_3Aranges_3A_3Ato_5Ffn_3C_20C_20_3E"><td class="memItemLeft">struct &#160;</td><td class="memItemRight"><a class="el" href="structjh_1_1ranges_1_1to__fn.html">jh::ranges::to_fn&lt; C &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function object implementing <code><a class="el" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15" title="Global instance of the to adaptor.">jh::ranges::to</a></code>.  <a href="structjh_1_1ranges_1_1to__fn.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae5e54c0ba31518c3451ad297dc995d15" id="r_ae5e54c0ba31518c3451ad297dc995d15"><td class="memTemplParams" colspan="2">template&lt;typename C, std::ranges::range R, typename... Args&gt; </td></tr>
<tr class="memitem:ae5e54c0ba31518c3451ad297dc995d15 template"><td class="memItemLeft">constexpr auto&#160;</td><td class="memItemRight"><a class="el" href="namespacejh_1_1ranges.html#ae5e54c0ba31518c3451ad297dc995d15">jh::ranges::to_adaptor</a> (R &amp;&amp;r, Args &amp;&amp;... args)</td></tr>
<tr class="memdesc:ae5e54c0ba31518c3451ad297dc995d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core implementation for <code><a class="el" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15" title="Global instance of the to adaptor.">jh::ranges::to</a></code> adaptor.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a722e1bdb5632bc636715eb47ed666b15" id="r_a722e1bdb5632bc636715eb47ed666b15"><td class="memTemplParams" colspan="2">template&lt;typename C&gt; </td></tr>
<tr class="memitem:a722e1bdb5632bc636715eb47ed666b15 template"><td class="memItemLeft">constexpr <a class="el" href="structjh_1_1ranges_1_1to__fn.html">to_fn</a>&lt; C &gt;&#160;</td><td class="memItemRight"><a class="el" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15">jh::ranges::to</a> {}</td></tr>
<tr class="memdesc:a722e1bdb5632bc636715eb47ed666b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global instance of the <code>to</code> adaptor.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Container adaptation adaptor — constructs a target container <code>C</code> directly from a compatible range <code>R</code>. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2025 JeongHan-Bae &lt;mastropseudo@gmail.com&gt; <br  />
 Licensed under the Apache License, Version 2.0 (the "License"); <br  />
 you may not use this file except in compliance with the License.<br  />
 You may obtain a copy of the License at<br  />
 <br  />
 <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a><br  />
 <br  />
 Unless required by applicable law or agreed to in writing, software<br  />
 distributed under the License is distributed on an "AS IS" BASIS,<br  />
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br  />
 See the License for the specific language governing permissions and<br  />
 limitations under the License.<br  />
 <br  />
 Full license: <a href="https://github.com/JeongHan-Bae/JH-Toolkit?tab=Apache-2.0-1-ov-file#readme">GitHub</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>JeongHan-Bae <a href="#" onclick="location.href='mai'+'lto:'+'mas'+'tr'+'ops'+'eu'+'do@'+'gm'+'ail'+'.c'+'om'; return false;">&lt;mastropseudo@gmail.com&gt;</a></dd></dl>
<p>The <code><a class="el" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15" title="Global instance of the to adaptor.">jh::ranges::to</a></code> adaptor provides a high-efficiency way to <b>directly construct</b> a container <code>C</code> from a range <code>R</code>, as long as they form a valid <code>closable_container_for</code> pair. </p>
<p>Conceptually, this corresponds to the <b>closable half</b> of the proposed C++23 <code>std::ranges::to</code>. Unlike <code><a class="el" href="namespacejh_1_1ranges.html#ae066e3cad87b5bec3c061fc290e8ad73" title="Global instance of the collect adaptor.">jh::ranges::collect</a></code>, which can always materialize a range via insertion or emplace iteration, <code>to</code> requires that the container and range are <em>structurally compatible</em> and can be constructed directly. </p>
<h3>Behavior overview</h3>
<ul>
<li>
If <code>C</code> can be directly constructed from <code>[begin(r), end(r)]</code>, the adaptor uses that constructor. </li>
<li>
If <code>C</code> supports move iterators, vector bridging, or underlying container adaptation, these strategies are automatically detected and applied. </li>
<li>
Constructor arguments (if any) are forwarded via <code>Args...</code>. </li>
</ul>
<h3>Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacejh_1_1ranges.html">jh::ranges</a>;</div>
<div class="line"> </div>
<div class="line">std::vector&lt;int&gt; v = {1, 2, 3, 4};</div>
<div class="line"> </div>
<div class="line">std::pmr::monotonic_buffer_resource pool;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Direct construction — requires closable_container_for&lt;std::pmr::vector&lt;int&gt;, std::vector&lt;int&gt;&gt;</span></div>
<div class="line"><span class="keyword">auto</span> pmr_vec = <a class="code hl_variable" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15">to&lt;std::pmr::vector&lt;int&gt;</a>&gt;(</div>
<div class="line">    v,</div>
<div class="line">    std::pmr::polymorphic_allocator&lt;int&gt;(&amp;pool)</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Equivalent pipe form</span></div>
<div class="line"><span class="keyword">auto</span> pmr_vec2 = v</div>
<div class="line">  | <a class="code hl_variable" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15">to&lt;std::pmr::vector&lt;int&gt;</a>&gt;(std::pmr::polymorphic_allocator&lt;int&gt;(&amp;pool));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// When the source range is not directly closable, normalize first:</span></div>
<div class="line"><span class="keyword">auto</span> pmr_vec3 = std::views::iota(0, 5)</div>
<div class="line">  | std::views::transform([](<span class="keywordtype">int</span> x) { <span class="keywordflow">return</span> x * x; })</div>
<div class="line">  | <a class="code hl_variable" href="namespacejh_1_1ranges.html#ae066e3cad87b5bec3c061fc290e8ad73">collect</a>&lt;std::vector&lt;int&gt;&gt;()</div>
<div class="line">  | <a class="code hl_variable" href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15">to&lt;std::pmr::vector&lt;int&gt;</a>&gt;(std::pmr::polymorphic_allocator&lt;int&gt;(&amp;pool));</div>
<div class="ttc" id="anamespacejh_1_1ranges_html"><div class="ttname"><a href="namespacejh_1_1ranges.html">jh::ranges</a></div><div class="ttdef"><b>Definition</b> sequence.h:155</div></div>
<div class="ttc" id="anamespacejh_1_1ranges_html_a722e1bdb5632bc636715eb47ed666b15"><div class="ttname"><a href="namespacejh_1_1ranges.html#a722e1bdb5632bc636715eb47ed666b15">jh::ranges::to</a></div><div class="ttdeci">constexpr to_fn&lt; C &gt; to</div><div class="ttdoc">Global instance of the to adaptor.</div><div class="ttdef"><b>Definition</b> to.h:347</div></div>
<div class="ttc" id="anamespacejh_1_1ranges_html_ae066e3cad87b5bec3c061fc290e8ad73"><div class="ttname"><a href="namespacejh_1_1ranges.html#ae066e3cad87b5bec3c061fc290e8ad73">jh::ranges::collect</a></div><div class="ttdeci">constexpr collect_fn&lt; C &gt; collect</div><div class="ttdoc">Global instance of the collect adaptor.</div><div class="ttdef"><b>Definition</b> collect.h:375</div></div>
</div><!-- fragment --><h3>Design rationale</h3>
<ul>
<li>
<b>Closability-first design:</b> Only works if <code>C</code> and <code>R</code> form a valid <code>closable_container_for</code> relation. </li>
<li>
<b>Optimal constructor dispatch:</b> Prefers native constructors, falls back to intermediate <code>std::vector</code> bridges if needed. </li>
<li>
<b>Full pipe compatibility:</b> Works seamlessly in range pipelines with or without additional constructor parameters. </li>
</ul>
<h3>Optimization semantics: <code>collect + to</code></h3>
<p>Under optimized compilation (C++20 and later), the combination <code>collect + to</code> behaves as a <em>semantic two-stage pipeline</em> but is compiled down to a near-optimal one-stage construction. <br  />
 Although <code>collect</code> materializes an intermediate container (usually <code>std::vector&lt;T&gt;</code>), the compiler's <b>RVO</b> and <b>move-propagation</b> rules ensure that no redundant copies occur for right-value ranges. </p>
<table class="doxtable">
<tr>
<th>Stage</th><th>Responsibility</th><th>Typical Behavior</th><th>Optimization Result</th></tr>
<tr>
<td><b>collect&lt;V&gt;()</b></td><td>Terminates lazy views and produces a normalized, value-semantic container (e.g. <code>std::vector&lt;pair&lt;K,V&gt;&gt;</code>).</td><td>Constructs a temporary container on the caller's stack.</td><td>RVO creates the container directly in the caller frame; no copy or move is required.</td></tr>
<tr>
<td><b>to&lt;C&gt;()</b></td><td>Adapts the collected data into the final container <code>C</code> via its constructor (<code>[begin, end)</code>, move-iterators, or adapter dispatch).</td><td>Passes iterators of the temporary container.</td><td>Because the source is a right-value, the target container moves each element; no deep copy occurs.</td></tr>
<tr>
<td><b>Overall pipeline</b></td><td>Two semantic stages: materialization + construction.</td><td>Intermediate vector exists logically but not physically duplicated.</td><td>Equivalent runtime cost to <code>C(std::make_move_iterator(...))</code>; no extra allocations, deterministic lifetime.</td></tr>
</table>
<h4>Why this design is semantically superior</h4>
<ul>
<li>
<b>Explicit materialization point:</b> The exact moment a lazy range becomes concrete is visible and controllable. </li>
<li>
<b>Allocator and resource safety:</b> Construction parameters are isolated in <code>to</code>, preventing accidental cross-allocator moves. </li>
<li>
<b>Predictable evaluation order:</b> No hidden eager materialization as in <code>std::ranges::to</code>. </li>
<li>
<b>Copy-safe yet move-efficient:</b> Even though <code>return C(begin(r), end(r))</code> is specified as a copy operation, compilers perform per-element <code>move</code> for right-value containers, achieving optimal performance without losing semantic clarity. </li>
<li>
<b>Transparent lifetime management:</b> The intermediate vector's scope is clear, making debugging and reasoning about resource ownership trivial. </li>
</ul>
<p>In practice, <code>collect + to</code> achieves the same performance as a monolithic <code>std::ranges::to</code> call while providing stronger guarantees of safety, clarity, and composability within a range pipeline. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacejh_1_1ranges.html#ae066e3cad87b5bec3c061fc290e8ad73" title="Global instance of the collect adaptor.">jh::ranges::collect</a> </dd>
<dd>
<a class="el" href="conceptjh_1_1concepts_1_1closable__container__for.html" title="Concept checking whether a container C can be directly constructed (&quot;closed&quot;) from a range R.">jh::concepts::closable_container_for</a> </dd></dl>
<dl class="section version"><dt>Version</dt><dd><pre>1.3.x</pre> </dd></dl>
<dl class="section date"><dt>Date</dt><dd><pre>2025</pre> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
</div> <!-- top -->
<hr class="footer"/>
<div class="footer">
    <img class="footer-logo" src="Ojing.svg" alt="Ojing"/>
    <div class="footer-text">
        JH-Toolkit v1.4.0 · Generated by Doxygen
    </div>
    <div class="footer-note">
        We primarily support embedded documentation views in IDEs (classic CLion).
        To ensure compatibility with embedded rendering, some example code in this
        documentation intentionally contains HTML entities.
        In certain cases, Doxygen does not unescape these entities correctly.
        This is a known limitation and currently has no workaround.
    </div>
</div>
</body>
</html>
